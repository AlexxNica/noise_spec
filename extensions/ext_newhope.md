---
title:      'Noise Extension: New Hope'
author:     'Rhys Weatherley (rhys.weatherley@gmail.com)'
revision:   '1draft-4'
date:       '2016-12-19'
---

1. Introduction
===============

This document describes the post-quantum key exchange algorithm New Hope
and provides information for using it with the Noise protocol.

New Hope [1,2] is a Diffie-Hellman like key exchange mechanism based on
the Ring Learning with Errors (Ring-LWE) problem.  It is believed to be
secure against an adversary with a quantum computer.  It provides the
equivalent of 128 bits of security.

New Hope is unusual in that its key sizes and operations vary based on
the party:

 * Alice generates a 1824-byte public key and a 2048-byte private key.
   Her 1824-byte public key is sent to Bob.
 * Bob uses Alice's public key to generate his own 2176-byte public key
   and a 32-byte shared secret.  His 2176-byte public key is sent to Alice.
 * Alice uses her 2048-byte private key and Bob's 2176-byte public key
   to generate her copy of the 32-byte shared secret.

New Hope supports ephemeral key exchange only, which makes it suitable
for use with the separate "Hybrid Forward Secrecy" extension to Noise.
While New Hope could be used as a regular DH function with the `NN`
pattern, we do not define that here.

2. Definition of `NewHope` for use in Noise
===========================================

The authors of New Hope have refined the algorithm from the original
paper [1] to produce a simpler version without reconciliation [2].
It is this "NewHope-Simple" version that we standardize for use in
Noise under the function name `NewHope`.  The previous "ref" and
"torref" variants are not used.

The function and constant definitions for hybrid forward secrecy are
as follows:

 * **`GENERATE_KEYPAIR_F(rf)`**:
   * If `rf` is empty, then returns the result of `newhope_keygen()`
     which has the two components `private_key` and `public_key`.
   * If `rf` is not empty, then returns the result of `newhope_sharedb(r)`
     which has the two components `shared` and `public_key`.

 * **`FF(key_pair, public_key)`**: If `key_pair` was generated by
   `GENERATE_KEYPAIR_F(rf)` with an empty `rf`, then return the result of
   `newhope_shareda(key_pair.private_key, public_key)`.  Otherwise
   return `key_pair.shared` and ignore `public_key`.

 * **`FLEN1`** = 1824

 * **`FLEN2`** = 2176

 * **`FFLEN`** = 32

3. Test vector definition
=========================

The Noise test vector format assumes that fixed ephemeral keys can be
set using only their private key.  However, the New Hope API does not
expose a private key in the same sense as `25519` and `448`.

The reference implementation of New Hope acquires 64 bytes of random
seed data from the system to generate the key pair for Alice and the
public "a" value.  The reference implementation acquires 32 bytes of
random seed data from the system to generate the key pair for Bob
relative to "a".

The 64 or 32 bytes of random seed data can be used as the "private key"
component for ephemeral keys in test vectors.

4. Examples
===========

The following are examples of protocol names involving New Hope:

 * `Noise_XXhfs_25519+NewHope_AESGCM_SHA256`
 * `Noise_XXfallback+hfs_448+NewHope_ChaChaPoly_BLAKE2b`

5. References
=============

[1] Erdem Alkim, Léo Ducas, Thomas Pöppelmann, and Peter Schwabe:
[Post-quantum key exchange – a new hope](https://cryptojedi.org/papers/#newhope).
Proceedings of the 25th USENIX Security Symposium.

[2] Erdem Alkim, Léo Ducas, Thomas Pöppelmann, and Peter Schwabe:
[NewHope without reconciliation](https://cryptojedi.org/papers/#newhopesimple).

[3] [Reference implementation of New Hope](https://cryptojedi.org/crypto/#newhope).
